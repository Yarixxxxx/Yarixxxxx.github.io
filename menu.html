<!DOCTYPE html>
<html>
<head>
    <title>Menu</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
</head>
<body>
    <h1>Menu</h1>
    <form id="orderForm">
        <ul>
            {% for item in menu %}
            <li>
                <label>
                    <input type="checkbox" name="order" value="{{ item.id }}"> {{ item.name }} - ${{ item.price }}
                </label>
            </li>
            {% endfor %}
        </ul>
        <button type="button" onclick="submitOrder()">Place Order</button>
    </form>

    <script>
        function submitOrder() {
            const selectedItems = Array.from(document.querySelectorAll('input[name="order"]:checked')).map(cb => cb.value);
            const data = { items: selectedItems };

            fetch('/order', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(data)
            }).then(response => response.json())
              .then(data => {
                  if (data.status === 'success') {
                      Telegram.WebApp.sendData(JSON.stringify(data.order));
                  }
              });
        }

        Telegram.WebApp.ready();
    </script>
</body>
</html>
